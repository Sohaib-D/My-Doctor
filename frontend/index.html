<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
      (() => {
        const SETTINGS_KEY = 'pd_app_settings';
        const root = document.documentElement;
        let appearance = 'system';

        try {
          const raw = window.localStorage.getItem(SETTINGS_KEY);
          if (raw) {
            const parsed = JSON.parse(raw);
            const candidate =
              parsed && typeof parsed === 'object' ? String(parsed.appearance || '').toLowerCase() : '';
            if (candidate === 'light' || candidate === 'dark' || candidate === 'system') {
              appearance = candidate;
            }
          }
        } catch {
          appearance = 'system';
        }

        const prefersDark =
          typeof window.matchMedia === 'function' &&
          window.matchMedia('(prefers-color-scheme: dark)').matches;
        const mode =
          appearance === 'light' || appearance === 'dark' ? appearance : prefersDark ? 'dark' : 'light';

        root.classList.remove('theme-system', 'theme-light', 'theme-dark', 'light', 'dark');
        root.classList.add(`theme-${appearance}`, `theme-${mode}`, mode);
        root.style.colorScheme = mode;
        root.style.backgroundColor = mode === 'dark' ? '#0f172a' : '#f8fafc';
      })();
    </script>
    <title>Personal Doctor</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
